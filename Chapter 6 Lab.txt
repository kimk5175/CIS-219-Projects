Student Name: Kim
Chapter 6 Lab Assignment

HANDS-ON Exercises.

Answer to Question 1
================

SQL> CREATE SEQUENCE customer_seq
  2  START WITH 1021
  3  INCREMENT BY 1
  4  NOMAXVALUE
  5  NOMINVALUE
  6  NOCYCLE
  7  NOCACHE;

Sequence created.

SQL> SELECT sequence_name
  2  FROM user_sequences
  3  WHERE sequence_name = 'CUSTOMER_SEQ';

SEQUENCE_NAME
--------------------------------------------------------------------------------
CUSTOMER_SEQ


Answer to Question 2
================

SQL> INSERT INTO CUSTOMERS (Customer#, LastName, FirstName, Zip)
  2  VALUES (customer_seq.NEXTVAL, 'Shoulders', 'Frank', 23567);

1 row created.

SQL> SELECT * FROM CUSTOMERS;

 CUSTOMER# LASTNAME   FIRSTNAME  ADDRESS              CITY         ST ZIP
---------- ---------- ---------- -------------------- ------------ -- -----
  REFERRED RE EMAIL
---------- -- ------------------------------
      1001 MORALES    BONITA     P.O. BOX 651         EASTPOINT    FL 32328
           SE bm225@sat.net

      1002 THOMPSON   RYAN       P.O. BOX 9835        SANTA MONICA CA 90404
           W

      1003 SMITH      LEILA      P.O. BOX 66          TALLAHASSEE  FL 32306
           SE


 CUSTOMER# LASTNAME   FIRSTNAME  ADDRESS              CITY         ST ZIP
---------- ---------- ---------- -------------------- ------------ -- -----
  REFERRED RE EMAIL
---------- -- ------------------------------
      1004 PIERSON    THOMAS     69821 SOUTH AVENUE   BOISE        ID 83707
           NW tpier55@sat.net

      1005 GIRARD     CINDY      P.O. BOX 851         SEATTLE      WA 98115
           NW cing101@zep.net

      1006 CRUZ       MESHIA     82 DIRT ROAD         ALBANY       NY 12211
           NE cruztop@axe.com


 CUSTOMER# LASTNAME   FIRSTNAME  ADDRESS              CITY         ST ZIP
---------- ---------- ---------- -------------------- ------------ -- -----
  REFERRED RE EMAIL
---------- -- ------------------------------
      1007 GIANA      TAMMY      9153 MAIN STREET     AUSTIN       TX 78710
      1003 SW treetop@zep.net

      1008 JONES      KENNETH    P.O. BOX 137         CHEYENNE     WY 82003
           N  kenask@sat.net

      1009 PEREZ      JORGE      P.O. BOX 8564        BURBANK      CA 91510
      1003 W  jperez@canet.com


 CUSTOMER# LASTNAME   FIRSTNAME  ADDRESS              CITY         ST ZIP
---------- ---------- ---------- -------------------- ------------ -- -----
  REFERRED RE EMAIL
---------- -- ------------------------------
      1010 LUCAS      JAKE       114 EAST SAVANNAH    ATLANTA      GA 30314
           SE

      1011 MCGOVERN   REESE      P.O. BOX 18          CHICAGO      IL 60606
           N  reesemc@sat.net

      1012 MCKENZIE   WILLIAM    P.O. BOX 971         BOSTON       MA 02110
           NE will2244@axe.net


 CUSTOMER# LASTNAME   FIRSTNAME  ADDRESS              CITY         ST ZIP
---------- ---------- ---------- -------------------- ------------ -- -----
  REFERRED RE EMAIL
---------- -- ------------------------------
      1013 NGUYEN     NICHOLAS   357 WHITE EAGLE AVE. CLERMONT     FL 34711
      1006 SE nguy33@sat.net

      1014 LEE        JASMINE    P.O. BOX 2947        CODY         WY 82414
           N  jaslee@sat.net

      1015 SCHELL     STEVE      P.O. BOX 677         MIAMI        FL 33111
           SE sschell3@sat.net


 CUSTOMER# LASTNAME   FIRSTNAME  ADDRESS              CITY         ST ZIP
---------- ---------- ---------- -------------------- ------------ -- -----
  REFERRED RE EMAIL
---------- -- ------------------------------
      1016 DAUM       MICHELL    9851231 LONG ROAD    BURBANK      CA 91508
      1010 W

      1017 NELSON     BECCA      P.O. BOX 563         KALMAZOO     MI 49006
           N  becca88@digs.com

      1018 MONTIASA   GREG       1008 GRAND AVENUE    MACON        GA 31206
           SE greg336@sat.net


 CUSTOMER# LASTNAME   FIRSTNAME  ADDRESS              CITY         ST ZIP
---------- ---------- ---------- -------------------- ------------ -- -----
  REFERRED RE EMAIL
---------- -- ------------------------------
      1019 SMITH      JENNIFER   P.O. BOX 1151        MORRISTOWN   NJ 07962
      1003 NE

      1020 FALAH      KENNETH    P.O. BOX 335         TRENTON      NJ 08607
           NE Kfalah@sat.net

      1021 Shoulders  Frank                                           23567



21 rows selected.


Answer to Question 3
================

SQL> CREATE SEQUENCE MY_FIRST_SEQ
  2  START WITH 5
  3  INCREMENT BY -3
  4  MINVALUE 0
  5  MAXVALUE 5
  6  NOCYCLE;

Sequence created.

SQL> SELECT sequence_name, increment_by, min_value, max_value, cycle_flag
  2  FROM user_sequences
  3  WHERE sequence_name = 'MY_FIRST_SEQ';

SEQUENCE_NAME
--------------------------------------------------------------------------------
INCREMENT_BY  MIN_VALUE  MAX_VALUE C
------------ ---------- ---------- -
MY_FIRST_SEQ
          -3          0          5 N


Answer to Question 4
================


SQL> SELECT MY_FIRST_SEQ.NEXTVAL FROM dual;

   NEXTVAL
----------
         5

SQL> SELECT MY_FIRST_SEQ.NEXTVAL FROM dual;

   NEXTVAL
----------
         2

SQL> SELECT MY_FIRST_SEQ.NEXTVAL FROM dual;
SELECT MY_FIRST_SEQ.NEXTVAL FROM dual
*
ERROR at line 1:
ORA-08004: sequence MY_FIRST_SEQ.NEXTVAL goes below MINVALUE and cannot be
instantiated


There is a MIN value of 0 and by the third iteration the value is -1, lower than the MIN value.


Answer to Question 5
================

SQL> DROP SEQUENCE MY_FIRST_SEQ;

Sequence dropped.

SQL> CREATE SEQUENCE MY_FIRST_SEQ
  2  START WITH 5
  3  INCREMENT BY -3
  4  MINVALUE -1000
  5  MAXVALUE 5
  6  NOCYCLE;

Sequence created.


Answer to Question 6
================


SQL> CREATE TABLE email_log (
  2      emailid NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  3      emaildate DATE NOT NULL,
  4      customer# NUMBER NOT NULL
  5  );

Table created.

SQL> INSERT INTO email_log (emaildate, customer#)
  2  VALUES (SYSDATE, 1007);

1 row created.

SQL> INSERT INTO email_log (emaildate, customer#)
  2  VALUES (SYSDATE, 1008);

1 row created.

SQL> INSERT INTO email_log (emailid, emaildate, customer#)
  2  VALUES (25, SYSDATE, 1009);
INSERT INTO email_log (emailid, emaildate, customer#)
                       *
ERROR at line 1:
ORA-32795: cannot insert into a generated always identity column


Error occurs because you cannot manually insert a value into the IDENTITY column


Answer to Question 7
================

SQL> CREATE SYNONYM NUMGEN FOR MY_FIRST_SEQ;

Synonym created.

SQL> SELECT synonym_name, table_name
  2  FROM user_synonyms
  3  WHERE synonym_name = 'NUMGEN';

SYNONYM_NAME
--------------------------------------------------------------------------------
TABLE_NAME
--------------------------------------------------------------------------------
NUMGEN
MY_FIRST_SEQ


Answer to Question 8
================

SQL> SELECT NUMGEN.NEXTVAL FROM dual;

   NEXTVAL
----------
         5

SQL> SELECT NUMGEN.CURRVAL FROM dual;

   CURRVAL
----------
         5

SQL> DROP SYNONYM NUMGEN;

Synonym dropped.



Answer to Question 9
================

SQL> CREATE BITMAP INDEX customers_state_bi
  2  ON CUSTOMERS(state);

Index created.

SQL> SELECT index_name, table_name, index_type
  2  FROM user_indexes
  3  WHERE index_name = 'CUSTOMERS_STATE_BI';

INDEX_NAME
--------------------------------------------------------------------------------
TABLE_NAME
--------------------------------------------------------------------------------
INDEX_TYPE
---------------------------
CUSTOMERS_STATE_BI
CUSTOMERS
BITMAP


SQL> DROP INDEX customers_state_bi;

Index dropped.

SQL> SELECT index_name, table_name, index_type
  2  FROM user_indexes
  3  WHERE index_name = 'CUSTOMERS_STATE_BI';

no rows selected


Answer to Question 10
================

SQL> CREATE INDEX customers_lastname_idx
  2  ON CUSTOMERS(Lastname);

Index created.

SQL> SELECT index_name, table_name, index_type
  2  FROM user_indexes
  3  WHERE index_name = 'CUSTOMERS_LASTNAME_IDX';

INDEX_NAME
--------------------------------------------------------------------------------
TABLE_NAME
--------------------------------------------------------------------------------
INDEX_TYPE
---------------------------
CUSTOMERS_LASTNAME_IDX
CUSTOMERS
NORMAL


SQL> DROP INDEX customers_lastname_idx;

Index dropped.

SQL> SELECT index_name, table_name, index_type
  2  FROM user_indexes
  3  WHERE index_name = 'CUSTOMERS_LASTNAME_IDX';

no rows selected



Answer to Question 11
================

SQL> CREATE INDEX days_to_ship_idx
  2  ON orders(TRUNC(shipdate) - TRUNC(orderdate));

Index created.

SQL> SELECT index_name, table_name, index_type
  2  FROM user_indexes
  3  WHERE index_name = 'DAYS_TO_SHIP_IDX';

INDEX_NAME
--------------------------------------------------------------------------------
TABLE_NAME
--------------------------------------------------------------------------------
INDEX_TYPE
---------------------------
DAYS_TO_SHIP_IDX
ORDERS
FUNCTION-BASED NORMAL

SQL> SELECT *
  2  FROM orders
  3  WHERE TRUNC(shipdate) - TRUNC(orderdate) <= 5;

    ORDER#  CUSTOMER# ORDERDATE SHIPDATE  SHIPSTREET         SHIPCITY        SH
---------- ---------- --------- --------- ------------------ --------------- --
SHIPZ   SHIPCOST
----- ----------
      1003       1001 01-APR-09 01-APR-09 958 MAGNOLIA LANE  EASTPOINT       FL
32328          4

      1001       1010 31-MAR-09 01-APR-09 114 EAST SAVANNAH  ATLANTA         GA
30314          3

      1002       1011 31-MAR-09 01-APR-09 58 TILA CIRCLE     CHICAGO         IL
60605          3


    ORDER#  CUSTOMER# ORDERDATE SHIPDATE  SHIPSTREET         SHIPCITY        SH
---------- ---------- --------- --------- ------------------ --------------- --
SHIPZ   SHIPCOST
----- ----------
      1005       1018 01-APR-09 02-APR-09 1008 GRAND AVENUE  MACON           GA
31206          2

      1006       1003 01-APR-09 02-APR-09 558A CAPITOL HWY.  TALLAHASSEE     FL
32307          2

      1008       1004 02-APR-09 03-APR-09 69821 SOUTH AVENUE BOISE           ID
83707          3


    ORDER#  CUSTOMER# ORDERDATE SHIPDATE  SHIPSTREET         SHIPCITY        SH
---------- ---------- --------- --------- ------------------ --------------- --
SHIPZ   SHIPCOST
----- ----------
      1010       1019 03-APR-09 04-APR-09 384 WRONG WAY HOME MORRISTOWN      NJ
07960          2

      1013       1014 03-APR-09 04-APR-09 7618 MOUNTAIN RD.  CODY            WY
82414          2

      1014       1007 04-APR-09 05-APR-09 9153 MAIN STREET   AUSTIN          TX
78710          3


    ORDER#  CUSTOMER# ORDERDATE SHIPDATE  SHIPSTREET         SHIPCITY        SH
---------- ---------- --------- --------- ------------------ --------------- --
SHIPZ   SHIPCOST
----- ----------
      1017       1015 04-APR-09 05-APR-09 887 HOT ASPHALT ST MIAMI           FL
33222          3

      1000       1005 31-MAR-09 02-APR-09 1201 ORANGE AVE    SEATTLE         WA
98114          2

      1007       1007 02-APR-09 04-APR-09 9153 MAIN STREET   AUSTIN          TX
78710          7


    ORDER#  CUSTOMER# ORDERDATE SHIPDATE  SHIPSTREET         SHIPCITY        SH
---------- ---------- --------- --------- ------------------ --------------- --
SHIPZ   SHIPCOST
----- ----------
      1009       1005 03-APR-09 05-APR-09 9 LIGHTENING RD.   SEATTLE         WA
98110

      1011       1010 03-APR-09 05-APR-09 102 WEST LAFAYETTE ATLANTA         GA
30311          2

      1004       1020 01-APR-09 05-APR-09 561 ROUNDABOUT WAY TRENTON         NJ
08601


15 rows selected.




ADVANCED CHALLENGE Exercise

Three Indexes:
1) ISBN - Each book's ISBN is unique and is frequently used in searches.
2) Customer Email Address - Customers have unique email addresses and can be searched for a variety of uses.
3) Book ID - Inventory will have unique IDs associated with the product and will be another method to search for the books.

Disadvantage - Increased space usage.  However, as all 3 indexes have unique values, the drawback of updating the indexes will be
nonexistent.

Three Sequences:
1) Order Number - Each order has a unique ID for each unique customer.
2) Customer Number - Each customer has a unique ID and as customers are added will automatically have an ID assigned.
3) Book ID - Each product will be automatically assigned an ID when added to the inventory.

Disadvantage - potential for gaps due to transaction rollbacks and value in the sequence will be lost and unused.  These gaps
can further lead to confusion and issues when debugging.

